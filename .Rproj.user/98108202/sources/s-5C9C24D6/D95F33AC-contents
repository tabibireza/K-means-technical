install.packages("NbClust")
seg_data <- read.csv(file = "booking.csv",row.names=1)
head(seg_data)

# standardization
std_seg_data <- scale(seg_data[,c("staff", "Facilities", "cleanliness", "comfort", "value.of.money", "Location", "Free.Wifi")])
dist <- dist(std_seg_data, method = "euclidean")
as.matrix(dist)[1:6,1:6]

# hierarchical clustering
set.seed(1990)
clust <- hclust(dist, method = "ward.D2")



# Number of Clusters, we must use only 3 variables out of 6 to avoid collinearity issues.
library(NbClust)
set.seed(1990)
NbClust(data=std_seg_data[,1:6], min.nc=3, max.nc=15, index="all", method="ward.D2")



# cutree 3
plot(clust)
h_cluster <- cutree(clust,3)
rect.hclust(clust, k=3, border="red")
table(h_cluster)
seg_data$cluster <- h_cluster
head(seg_data)
write.csv(seg_data, file = "E:/towork/study/DBA/marketingintelligence/assess1-digitalreview/clustringhotels/hotelcluster.csv")


#the clustering variables means by cluster
hclust_summary <- aggregate(std_seg_data[,c("staff", "Facilities", "cleanliness", "comfort", "value.of.money", 
                                            "Location", "Free.Wifi")],by=list(h_cluster),FUN=mean)
hclust_summary


#  focus on a given cluster
plot(cut(as.dendrogram(clust), h=9)$lower[[1]])
